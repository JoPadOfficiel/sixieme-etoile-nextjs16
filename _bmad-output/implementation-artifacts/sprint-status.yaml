# generated: 2026-01-20T04:26:13+01:00
# project: sixieme-etoile-nextjs16
# project_key: file-system-local
# tracking_system: file-system
# story_location: _bmad-output/implementation-artifacts

# STATUS DEFINITIONS:
# ==================
# Epic Status:
#   - backlog: Epic not yet started
#   - in-progress: Epic actively being worked on
#   - done: All stories in epic completed
#
# Epic Status Transitions:
#   - backlog → in-progress: Automatically when first story is created (via create-story)
#   - in-progress → done: Manually when all stories reach 'done' status
#
# Story Status:
#   - backlog: Story only exists in epic file
#   - ready-for-dev: Story file created in stories folder
#   - in-progress: Developer actively working on implementation
#   - review: Ready for code review (via Dev's code-review workflow)
#   - done: Story completed
#
# Retrospective Status:
#   - optional: Can be completed but not required
#   - done: Retrospective has been completed
#
# WORKFLOW NOTES:
# ===============
# - Epic transitions to 'in-progress' automatically when first story is created
# - Stories can be worked in parallel if team capacity allows
# - SM typically creates next story after previous one is 'done' to incorporate learnings
# - Dev moves story to 'review', then runs code-review (fresh context, different LLM recommended)

generated: 2026-01-20T04:26:13+01:00
project: sixieme-etoile-nextjs16
project_key: file-system-local
tracking_system: file-system
story_location: _bmad-output/implementation-artifacts

development_status:
  epic-1: done
  1-1-define-vtc-erp-prisma-models: done
  1-2-enforce-organization-level-multi-tenancy: done
  1-3-implement-eur-only-monetary-representation: done
  1-4-implement-europe-paris-business-time-strategy: done
  1-5-integration-settings-storage-for-google-maps-collectapi: done
  epic-1-retrospective: optional
  epic-2: done
  2-1-implement-contact-model-basic-crm-ui: done
  2-2-store-partner-contract-data-rate-grid-links: done
  2-3-allow-safe-reclassification-between-partner-and-private: done
  2-4-link-quotes-and-invoices-to-contacts-partner-agencies: done
  2-5-expose-commercial-context-in-crm-views: done
  epic-2-retrospective: optional
  epic-3: done
  3-1-implement-pricingzone-model-zones-editor-ui: done
  3-2-implement-zoneroute-model-grid-routes-editor: done
  3-3-implement-excursion-dispo-forfait-configuration: done
  3-4-apply-engagement-rule-for-partner-grid-trips: done
  3-5-fallback-to-dynamic-pricing-when-no-grid-match-exists: done
  3-6-visualise-grid-coverage-and-gaps: done
  epic-3-retrospective: optional
  epic-4: done
  4-1-implement-base-dynamic-price-calculation: done
  4-2-add-operational-cost-components-to-internal-cost: done
  4-3-apply-multipliers-and-target-margins: done
  4-4-allow-operator-override-with-live-profitability-feedback: done
  4-5-implement-multi-base-candidate-selection-pre-filter: done
  4-6-implement-shadow-calculation-segments-a-b-c-tripanalysis-storage: done
  4-7-compute-expose-profitability-indicator: done
  4-8-use-fuel-price-cache-in-pricing-engine: done
  epic-4-retrospective: optional
  epic-5: done
  5-1-implement-fleet-models-fleet-bases-ui: done
  5-2-implement-drivers-licence-categories-rse-rules: done
  5-3-implement-heavy-vehicle-compliance-validator: done
  5-4-suggest-alternative-staffing-scheduling-options: done
  5-5-track-rse-counters-per-driver-licence-regime: done
  5-6-surface-compliance-statuses-logs-in-ui: done
  epic-5-retrospective: optional
  epic-6: done
  6-1-implement-quotes-list-with-status-profitability: done
  6-2-implement-create-quote-3-column-cockpit: done
  6-3-implement-quote-detail-with-stored-tripanalysis: done
  6-4-implement-quote-lifecycle-status-transitions: done
  6-5-implement-blocking-non-blocking-alerts-for-impossible-or-risky-trips: done
  6-6-implement-helpers-for-common-scenarios-airport-capacity: done
  6-7-integrate-triptransparencypanel-profitability-indicator-across-screens: done
  6-8-manual-editing-of-cost-components-in-trip-transparency: done
  epic-6-retrospective: optional
  epic-7: done
  7-1-implement-invoice-invoiceline-models-and-invoices-ui: done
  7-2-convert-accepted-quote-to-invoice-with-deep-copy-semantics: done
  7-3-implement-vat-breakdown-for-transport-ancillary-services: done
  7-4-integrate-commission-calculation-into-invoices: done
  7-5-implement-document-generation-storage-for-quotes-invoices-mission-orders: done
  epic-7-retrospective: optional
  epic-8: done
  8-1-implement-dispatch-screen-layout-missions-list-map-transparency: done
  8-2-implement-assignment-drawer-with-candidate-vehicles-drivers-flexibility-score: done
  8-3-implement-multi-base-optimisation-visualisation: done
  8-4-detect-suggest-trip-chaining-opportunities: done
  8-5-model-surface-empty-leg-opportunities: done
  8-6-integrate-subcontractor-directory-subcontracting-suggestions: done
  8-7-surface-profitability-compliance-badges-for-missions: done
  epic-8-retrospective: optional
  epic-9: done
  9-1-implement-settings-pricing-seasonal-multipliers: done
  9-2-implement-settings-pricing-advanced-rate-modifiers: done
  9-3-implement-settings-pricing-optional-fees-catalogue: done
  9-4-implement-settings-pricing-promotions-promo-codes: done
  9-5-implement-settings-fleet-regulatory-configuration: done
  9-6-implement-settings-integrations-google-maps-collectapi: done
  9-7-implement-fuel-price-cache-refresh-staleness-rules: done
  9-8-implement-basic-profitability-yield-reporting: done
  epic-9-retrospective: optional
  epic-10: done
  10-1-fix-google-maps-integration-in-quotes-dispatch: done
  epic-10-retrospective: optional
  epic-11: done
  11-1-implement-unified-zone-management-with-interactive-map: done
  11-2-implement-postal-code-zone-creation: done
  11-3-integrate-zone-pricing-multipliers: done
  11-4-merge-seasonal-multipliers-advanced-rates-ui: done
  11-5-merge-optional-fees-promotions-ui: done
  11-6-implement-collapsible-main-sidebar: done
  11-7-remove-deprecated-advanced-rate-types: done
  11-8-implement-full-responsive-design-mobile-sidebar: done
  epic-11-retrospective: optional
  epic-12: done
  12-1-implement-partner-specific-pricing-schema: done
  12-2-implement-pricing-engine-override-support: done
  12-3-implement-partner-contract-override-ui: done
  epic-12-retrospective: optional
  epic-13: done
  13-1-fix-pricing-ui-translations: done
  13-2-implement-pricing-pages-partner-filter: done
  epic-13-retrospective: optional
  epic-14: done
  14-1-fix-vehicle-category-dropdown-bug: done
  14-2-extend-zoneroute-schema-for-multi-zone-address-support: done
  14-3-update-pricing-ui-for-flexible-routes: done
  14-4-implement-interactive-map-for-zone-selection: done
  14-5-update-pricing-engine-for-multi-zone-routes: done
  14-6-assign-rate-grids-to-partners-from-pricing-ui: done
  epic-14-retrospective: optional
  epic-15: done
  15-1-integrate-google-routes-api-for-real-toll-costs: done
  15-2-use-vehicle-specific-fuel-consumption-in-all-pricing-paths: done
  15-3-apply-vehicle-category-price-multipliers-in-dynamic-pricing: done
  15-4-use-vehicle-category-default-rates-for-dynamic-pricing: done
  15-5-differentiate-pricing-by-trip-type-transfer-excursion-dispo: done
  15-6-use-correct-fuel-type-from-vehicle-category: done
  15-7-propagate-cost-breakdown-to-quotes-and-invoices: done
  15-8-validate-pricing-consistency-across-application: done
  epic-15-retrospective: optional
  epic-16: done
  16-1-etendre-le-schema-quote-pour-les-types-de-trajets: done
  16-2-formulaire-dynamique-par-type-de-trajet: done
  16-3-integration-des-zones-dans-le-calcul-dynamique: done
  16-4-prix-bloques-pour-agences-partenaires: done
  16-5-simplifier-l-affichage-triptransparency: done
  16-6-calcul-prix-aller-retour-pour-transfer: done
  16-7-calcul-prix-excursion-multi-arrets: done
  16-8-calcul-prix-mise-a-disposition: done
  16-9-support-off-grid-avec-notes-obligatoires: done
  16-10-tests-e2e-pour-tous-les-types-de-trajets: done
  epic-16-retrospective: optional
  epic-17: done
  17-1-configurable-zone-conflict-resolution-strategy: done
  17-2-configurable-zone-multiplier-aggregation-strategy: done
  17-3-automatic-compliance-driven-staffing-integration: done
  17-4-configurable-staffing-cost-parameters: done
  17-5-quote-estimated-end-time-estimatedendat: done
  17-6-driver-calendar-events-model: done
  17-7-driver-availability-overlap-detection: done
  17-8-weighted-day-night-rate-application: done
  17-9-configurable-time-buckets-for-mad-pricing: done
  17-10-zone-fixed-surcharges-friction-costs: done
  17-11-zone-topology-validation-tools: done
  17-12-driver-home-location-for-deadhead-calculations: done
  17-13-route-segmentation-for-multi-zone-trips: done
  17-14-vehicle-tco-model-enrichment: done
  17-15-client-difficulty-score-patience-tax: done
  17-16-fr-group-9-settings-ui-integration: done
  epic-17-retrospective: optional
  epic-18: done
  18-1-corridor-zone-type-highway-buffers: done
  18-2-automatic-transfer-to-mad-detection-dense-zone: done
  18-3-round-trip-to-mad-automatic-detection: done
  18-4-loss-of-exploitation-opportunity-cost-calculation: done
  18-5-stay-vs-return-empty-scenario-comparison: done
  18-6-multi-scenario-route-optimization-min-t-min-d-min-tco: done
  18-7-transversal-trip-decomposition: done
  18-8-fixed-temporal-vectors-classic-destinations: done
  18-9-shadow-fleet-integration-subcontractors: done
  18-10-hierarchical-pricing-algorithm-implementation: done
  18-11-configurable-transfer-to-mad-thresholds: done
  epic-18-retrospective: optional
  epic-19: done
  19-1-fix-double-category-pricing: done
  19-2-implement-automatic-rse-compliant-staffing-for-long-trips: done
  19-3-fix-excursion-pricing-to-include-return-trip-cost: done
  19-4-fix-dispo-pricing-formula: done
  19-5-fix-off-grid-trip-type-to-show-manual-pricing-ui: done
  19-6-implement-automatic-vehicle-category-selection-based-on-capacity: done
  19-7-fix-route-trace-display-on-quote-map: done
  19-8-fix-vehicle-driver-assignment-in-dispatch: done
  19-9-enlarge-assignment-and-detail-panels-in-dispatch: done
  19-10-move-ui-blocks-for-better-quote-layout: done
  19-11-add-address-field-to-operating-base-form: done
  19-12-display-driver-missions-in-driver-calendar: done
  19-13-validate-zone-conflict-resolution-for-concentric-circles: done
  19-14-add-comprehensive-pricing-tests: done
  19-15-decompose-pricing-engine-into-modular-architecture: done
  19-16-implement-mandatory-testing-protocol-for-all-stories: done
  epic-19-retrospective: optional
  epic-20: done
  20-1-fix-triptransparencypanel-segments-null-safety: done
  20-2-migrate-to-google-routes-api: done
  20-3-integrate-real-toll-costs-from-routes-api: done
  20-4-fix-rse-second-driver-cost-calculation: done
  20-5-integrate-collectapi-diesel-price: done
  20-6-fix-vehicle-category-price-multiplier-application: done
  20-7-fix-route-display-on-quote-detail-map: done
  20-8-implement-dual-driver-assignment-for-rse-trips: done
  20-9-comprehensive-end-to-end-testing-suite: done
  20-10-validate-reports-page-functionality: done
  epic-20-retrospective: optional
  epic-21: done
  21-1-ultra-detailed-staffing-costs-display-in-triptransparency: done
  21-2-detailed-approach-fee-and-empty-return-display: done
  21-3-ultra-detailed-travel-time-calculation-breakdown: done
  21-4-pricing-segments-and-traversed-zones-visualization: done
  21-5-rse-staffing-integration-in-dispatch: done
  21-6-automatic-empty-return-and-availability-calculation: done
  21-7-enhanced-triptransparency-interface-with-detailed-calculation: done
  21-8-zone-based-cost-transparency-enhancement: done
  21-9-real-time-cost-calculation-validation: done
  epic-21-retrospective: optional
  epic-22: done
  22-1-fix-round-trip-pricing-calculation: done
  22-2-display-staffing-costs-in-quote-creation: done
  22-3-enable-quote-notes-modification-after-sending: done
  22-4-implement-complete-subcontracting-system: done
  22-5-add-stay-trip-type-data-model-api: done
  22-6-implement-stay-trip-type-frontend-interface: done
  22-7-implement-stay-trip-type-pricing-engine: done
  22-8-implement-stay-trip-type-invoice-integration: done
  22-9-enhance-dispatch-with-staffing-information-display: done
  22-10-implement-advanced-subcontracting-workflow: done
  22-11-fix-quote-notes-display-in-dispatch: done
  22-12-implement-comprehensive-testing-suite: done
  22-13-update-documentation-and-training-materials: done
  epic-22-retrospective: optional
  epic-23: done
  23-1-fix-pricing-routes-excursions-disposals-loading-state-bug: done
  23-2-fix-multizoneselect-click-bug: done
  23-3-fix-pricing-adjustment-dialogs-freeze-on-cancel-save: done
  23-4-fix-positioning-costs-display-in-quote-trip-transparency: done
  23-5-add-vehicle-category-field-to-pricing-adjustment-data-models: done
  23-6-implement-vehicle-category-filter-ui-in-pricing-adjustment-forms: done
  23-7-update-pricing-engine-to-filter-by-vehicle-category: done
  23-8-display-vehicle-category-column-in-pricing-adjustment-lists: done
  23-9-add-vehicle-category-filter-to-quote-fee-promotion-catalog: done
  23-10-implement-automated-e2e-tests-for-bug-fixes: done
  23-11-implement-vehicle-category-filter-tests: done
  epic-23-retrospective: optional
  epic-24: done
  24-1-create-endcustomer-data-model: done
  24-2-implement-endcustomer-crud-api: done
  24-3-add-endcustomer-section-to-partner-contact-detail-page: done
  24-4-add-endcustomer-selector-to-quote-creation-form: done
  24-5-display-endcustomer-name-on-quote-summary-and-pdf: done
  24-6-display-endcustomer-name-on-invoice-documents: done
  24-7-integrate-endcustomer-in-dispatch-interface: done
  24-8-link-difficulty-score-to-endcustomer-for-pricing: done
  24-9-implement-bidirectional-pricing-toggle-in-quote-form: done
  24-10-add-endcustomer-search-and-filtering: done
  24-11-implement-automated-e2e-tests-for-mini-crm: done
  24-12-update-documentation-for-mini-crm-feature: done
  epic-24-retrospective: optional
  epic-25: done
  25-1-generate-manage-mission-sheets-fiche-mission: done
  25-2-eu-compliant-invoice-quote-pdf-layout: done
  25-3-organisation-document-personalization: done
  25-4-b2c-invoicing-address-agency-transparency: done
  25-5-deep-linking-navigation-crm-ux-improvements: done
  25-6-multi-invoice-payment-tracking-lettrage: done
  epic-25-retrospective: optional
  epic-26: done
  26-1-database-schema-update-for-hybrid-blocks: done
  26-2-backward-compatibility-migration-script: done
  26-3-hybrid-block-validation-layer-zod: done
  26-4-backend-api-crud-for-nested-lines: done
  26-5-ui-universal-block-row-component: done
  26-6-ui-click-to-edit-inline-forms: done
  26-7-ui-drag-drop-reordering-grouping: done
  26-8-ui-slash-commands-menu: done
  26-9-operational-detach-logic: done
  26-10-real-time-profitability-computation: done
  26-11-pdf-generator-pure-display-mode: done
  26-12-pdf-generator-mission-order-operational-mode: done
  26-13-block-presets-templates-bonus: done
  26-14-undo-redo-history-support: done
  26-15-remove-legacy-modes: done
  26-16-multi-trip-flow: done
  26-17-ux-improvements: done
  26-18-align-invoice-generation: done
  26-19-enhanced-quote-cart-interactions: done
  26-20-visual-polish-glassmorphism: done
  26-21-template-saving-for-multi-item-quotes: done
  epic-26-retrospective: optional
  epic-27: done
  27-1-dispatch-shell-navigation: done
  27-2-backend-mission-sync-service: done
  27-3-gantt-core-timeline-rendering: done
  27-4-gantt-mission-rendering-hybrid: done
  27-5-unassigned-backlog-sidebar-logic: done
  27-6-live-map-driver-locations-layer: done
  27-7-live-map-mission-context-layer: done
  27-8-map-smart-assignment-suggestions: done
  27-9-dispatch-actions-drag-drop-assignment: done
  27-10-conflict-detection-rse-calendar: done
  27-11-inspector-panel-quick-actions: done
  27-12-gantt-time-zoom-controls: done
  27-13-real-time-updates-polling-socket: done
  27-14-export-schedule: done
  epic-27-retrospective: optional
  epic-28: in-progress
  28-1-order-entity-prisma-schema: done
  28-2-order-state-machine-api: done
  28-3-dossier-view-ui-skeleton-tabs: done
  28-4-spawning-engine-trigger-logic: done
  28-5-group-spawning-logic-multi-day: done
  28-6-optional-dispatch-force-enable: done
  28-7-manual-item-handling: done
  28-8-invoice-generation-detached-snapshot: backlog
  28-9-invoice-ui-full-editability: backlog
  28-10-execution-feedback-loop-placeholders: backlog
  28-11-partial-invoicing: backlog
  28-12-post-mission-pending-charges: backlog
  28-13-ad-hoc-free-missions: backlog
  epic-28-retrospective: optional
